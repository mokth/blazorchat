<div class="message-input-container">
    <div class="input-actions">
        <button class="btn-icon" @onclick="HandleImageUpload" title="Send image" disabled="@isUploading">
            üì∑
        </button>
        <button class="btn-icon" @onclick="ToggleVoiceRecorder" title="Record voice" disabled="@isUploading">
            @if (isRecording)
            {
                <span>‚èπÔ∏è</span>
            }
            else
            {
                <span>üé§</span>
            }
        </button>
        <button class="btn-icon" @onclick="HandleFileUpload" title="Attach file" disabled="@isUploading">
            üìé
        </button>
    </div>

    <input type="file" @ref="imageInputRef" style="display:none" accept="image/*" @onchange="OnImageSelected" />
    <input type="file" @ref="fileInputRef" style="display:none" @onchange="OnFileSelected" />

    @if (isRecording)
    {
        <div class="recording-indicator">
            <span class="recording-dot"></span>
            Recording... @recordingDuration s
        </div>
    }
    else
    {
        <input type="text" 
               class="message-input" 
               placeholder="@Placeholder" 
               @bind="currentMessage" 
               @bind:event="oninput"
               @onkeydown="HandleKeyDown"
               disabled="@(!CanSend)" />
    }

    <button class="btn-send" @onclick="SendCurrentMessage" disabled="@(string.IsNullOrWhiteSpace(currentMessage) && !isRecording || !CanSend)">
        ‚û§
    </button>
</div>
